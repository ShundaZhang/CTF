import os
from pwn import *

bin = '\x4c\xb0\xa1\x45\xea\xf7\x36\x5a\x36\xc2\x43\x34\xfa\x43\x9a\xbf\xb7\xbf\xbf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\x38\xbd\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbf\xbb\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\xce\xbd\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\x3f\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\xe4\xbd\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbd\xbf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\xfa\xbd\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\x9f\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x90\xbd\xbf\xbf\x34\xfa\x43\x3c\x5f\xbb\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\xa4\xbd\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbf\xbd\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\xba\xbd\xbf\xbf\x34\xfa\x43\x9a\xbf\xbe\xbf\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x50\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xaf\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x66\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbb\xbf\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x7c\xbe\xbf\xbf\x34\xfa\x43\x9a\x3f\xbf\xbf\xbf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\x12\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xb7\xbf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\x28\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbf\xff\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\x3e\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xff\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\xd4\xbe\xbf\xbf\x34\xfa\x43\x3c\x5f\x9f\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\xe8\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbf\xaf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\xfe\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbf\x9f\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x94\xbe\xbf\xbf\x34\xfa\x43\x3c\x5f\xaf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\xa8\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbb\xbf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\xbe\xbe\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbe\xbf\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\x54\xbf\xbf\xbf\x34\xfa\x43\x9a\xbf\xaf\xbf\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x6a\xbf\xbf\xbf\x34\xfa\x43\x9a\xbf\xbd\xbf\xbf\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x00\xbf\xbf\xbf\x34\xfa\x43\x3c\x5f\xff\x3a\x7f\xcb\xb5\x07\xbf\xbf\xbf\xbf\x56\x14\xbf\xbf\xbf\x34\xfa\x43\x3a\x7f\xc7\xb5\x07\xbf\xbf\xbf\xbf\x56\x25\xbf\xbf\xbf\x34\xfa\x43\x9a\xbf\xbf\xbf\xb7\x3a\x7f\xca\xb5\x07\xbf\xbf\xbf\xbf\x56\x3b\xbf\xbf\xbf\x34\xfa\x43\x9a\xbf\x9f\xbf\xbf\x3a\x7f\xcb\xb8\x07\xbf\xbf\xbf\xbf\x54\xce\x34\xfa\x43\x3c\x5f\xb7\x3a\x7f\xcb\xb8\x07\xbf\xbf\xbf\xbf\x54\xdf\x34\xfa\x43\x9a\xbf\x3f\xbf\xbf\x3a\x7f\xcb\xb8\x07\xbf\xbf\xbf\xbf\x54\xf2\x34\xfa\x43\x3c\x5f\xbd\x3a\x7f\xca\xb8\x07\xbf\xbf\xbf\xbf\x54\x83\x34\xfa\x43\x9a\xbf\xbf\xbf\xbe\x3a\x7f\xca\xb8\x07\xbf\xbf\xbf\xbf\x54\x96\x34\xfa\x43\x3c\x5f\xbe\x3a\x7f\xcb\xb8\x07\xbf\xbf\xbf\xbf\x54\xa7\x34\xfa\x43\x9a\xbf\xff\xbf\xbf\x3a\x7f\xca\xb8\x07\xbf\xbf\xbf\xbf\x54\xba\x07\xbe\xbf\xbf\xbf\xe2\x7c'

'''
for i in range(256):
	buf = xor(bin, chr(i))
	#with open('bin'+str(i), 'w') as f:
	#	f.write(buf)
	print(str(i)+': '+buf.hex())


for i in range(256):
	print i
	io = process('./aegv2')
	io.recvuntil(' hmmm.....')
	io.sendline(str(i))
	io.sendline('0')
	print io.recvline()
	print io.recvline()
	print io.recvline()
	io.close()
'''
for i in range(256):
	process = os.popen('ndisasm -b 64 bin'+str(i))
	buf = process.read()
	process.close()
	with open('bin'+str(i)+'.asm', 'w') as f:
               f.write(buf)
