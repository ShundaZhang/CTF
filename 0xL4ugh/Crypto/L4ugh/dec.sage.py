'''
RSA Common Private Exponent
LLL
https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf
https://eprint.iacr.org/2009/037.pdf
https://github.com/ctfcompfest/compfest13-final/blob/master/cryptography/private/writeup/solve.py
'''


# This file was *autogenerated* from the file dec.sage
from sage.all_cmdline import *   # import sage library

_sage_const_206350931733134559046038012666264262159605459477114266661676711718071821567491611833459104662994828663089430087604498122614530857038303243536416583794909145512825702038109758926420015132996412362948521 = Integer(206350931733134559046038012666264262159605459477114266661676711718071821567491611833459104662994828663089430087604498122614530857038303243536416583794909145512825702038109758926420015132996412362948521); _sage_const_94197250246597982370705396844643503515932460553573983626120173393517660503268655297474603697012737312445858218256405854714069955450401963311893543006217094493508937469497805167571256355139719619029685487996809179708259694137417224263283453285738320197125322247896507992591707680253686046391096480690295151201 = Integer(94197250246597982370705396844643503515932460553573983626120173393517660503268655297474603697012737312445858218256405854714069955450401963311893543006217094493508937469497805167571256355139719619029685487996809179708259694137417224263283453285738320197125322247896507992591707680253686046391096480690295151201); _sage_const_113975832121158089182647315551205084085181501718368870318043598828318809353762032403859035663278617138894321663732151726924943108499963618857610020766601458677917711215952869831891816753479824041128382366582031662329821670569174512538773362191744665155198904324660767113612735029999746434387436990592685444637 = Integer(113975832121158089182647315551205084085181501718368870318043598828318809353762032403859035663278617138894321663732151726924943108499963618857610020766601458677917711215952869831891816753479824041128382366582031662329821670569174512538773362191744665155198904324660767113612735029999746434387436990592685444637); _sage_const_109029623096751263869487377146555821375870088210742951042157805388283914164227545988340849170566436801372200001409089167860932236741864751663216915390069567375472414750704074091284375886806123266064569536350495642225073285140643860042457226372310856136905802701425123952922907899478922460949692172650420392863 = Integer(109029623096751263869487377146555821375870088210742951042157805388283914164227545988340849170566436801372200001409089167860932236741864751663216915390069567375472414750704074091284375886806123266064569536350495642225073285140643860042457226372310856136905802701425123952922907899478922460949692172650420392863); _sage_const_37035204438541382584945963866321422234384515929039984832032294247909627890349395848653912080862899102940101178027760103147141297764322512687286126000209583224767151263628442616252557338988695990291402011698137054794919210520090762898886863953117629761556041483200540171163452668636360171424839287264029764867 = Integer(37035204438541382584945963866321422234384515929039984832032294247909627890349395848653912080862899102940101178027760103147141297764322512687286126000209583224767151263628442616252557338988695990291402011698137054794919210520090762898886863953117629761556041483200540171163452668636360171424839287264029764867); _sage_const_40741553336646670563014729950907182913999406666889432322375804493529253741247060388667028055696344550174949816312805197657996680023342222701496239510938247418731973519865617700134869274847579520786774092829833725881300681108094869611890509407830718683712941794245022643764865596870406539976022914002256045503 = Integer(40741553336646670563014729950907182913999406666889432322375804493529253741247060388667028055696344550174949816312805197657996680023342222701496239510938247418731973519865617700134869274847579520786774092829833725881300681108094869611890509407830718683712941794245022643764865596870406539976022914002256045503); _sage_const_43201525918300107090610272168894139235532066195297890820605957380139289247249656912211290268870091660752595059696872262382185067713317116432689408628729642220937968316782103946203421051233201840758380940907269161364979771956231662766935749272290030298347168438839298664987842775626131497578873225186665979219 = Integer(43201525918300107090610272168894139235532066195297890820605957380139289247249656912211290268870091660752595059696872262382185067713317116432689408628729642220937968316782103946203421051233201840758380940907269161364979771956231662766935749272290030298347168438839298664987842775626131497578873225186665979219); _sage_const_2 = Integer(2); _sage_const_333 = Integer(333); _sage_const_1 = Integer(1); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587568049291492293800615049951495318494958592724705602858676879233994302124445140659791546734810989943170 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587568049291492293800615049951495318494958592724705602858676879233994302124445140659791546734810989943170); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566643006902224826540565392288758924955959332986323844115579385290546124485418798925365327847293899888 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566643006902224826540565392288758924955959332986323844115579385290546124485418798925365327847293899888); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587571195070661149264565692450679057633526259843574220638356988904634529043381284248414745432338698627886 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587571195070661149264565692450679057633526259843574220638356988904634529043381284248414745432338698627886); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566106022909101398389731740153901980312300716487717493723006559548780133067603906830516359129772698830 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566106022909101398389731740153901980312300716487717493723006559548780133067603906830516359129772698830); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587569163096085001136348417235007807048895325685183381353206721858442003436809885045520395013423717833642 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587569163096085001136348417235007807048895325685183381353206721858442003436809885045520395013423717833642); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587568939645488133734460826463123128281215949573974953317158270226162420250916723778826057678812467002438 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587568939645488133734460826463123128281215949573974953317158270226162420250916723778826057678812467002438); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587567021649577650711030587073913249346330790130463066121302337115590141356777135750100465133439519479772 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587567021649577650711030587073913249346330790130463066121302337115590141356777135750100465133439519479772); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566020303375596454491683117839241955073989195341801650578125784026847327256151521544251575953546108052 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566020303375596454491683117839241955073989195341801650578125784026847327256151521544251575953546108052); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587572738835931114795008412518798210798917377929966411997907710561917009689892553082687586330871250960276 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587572738835931114795008412518798210798917377929966411997907710561917009689892553082687586330871250960276); _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566667458848921699486591979266292401778202294893137875877929891618811098311914713950497660573478162418 = Integer(15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566667458848921699486591979266292401778202294893137875877929891618811098311914713950497660573478162418); _sage_const_4 = Integer(4); _sage_const_0 = Integer(0); _sage_const_3 = Integer(3)#from pwn import *

d0 = _sage_const_206350931733134559046038012666264262159605459477114266661676711718071821567491611833459104662994828663089430087604498122614530857038303243536416583794909145512825702038109758926420015132996412362948521 

Ns=[_sage_const_94197250246597982370705396844643503515932460553573983626120173393517660503268655297474603697012737312445858218256405854714069955450401963311893543006217094493508937469497805167571256355139719619029685487996809179708259694137417224263283453285738320197125322247896507992591707680253686046391096480690295151201 , _sage_const_113975832121158089182647315551205084085181501718368870318043598828318809353762032403859035663278617138894321663732151726924943108499963618857610020766601458677917711215952869831891816753479824041128382366582031662329821670569174512538773362191744665155198904324660767113612735029999746434387436990592685444637 , _sage_const_109029623096751263869487377146555821375870088210742951042157805388283914164227545988340849170566436801372200001409089167860932236741864751663216915390069567375472414750704074091284375886806123266064569536350495642225073285140643860042457226372310856136905802701425123952922907899478922460949692172650420392863 ]

es=[_sage_const_37035204438541382584945963866321422234384515929039984832032294247909627890349395848653912080862899102940101178027760103147141297764322512687286126000209583224767151263628442616252557338988695990291402011698137054794919210520090762898886863953117629761556041483200540171163452668636360171424839287264029764867 , _sage_const_40741553336646670563014729950907182913999406666889432322375804493529253741247060388667028055696344550174949816312805197657996680023342222701496239510938247418731973519865617700134869274847579520786774092829833725881300681108094869611890509407830718683712941794245022643764865596870406539976022914002256045503 , _sage_const_43201525918300107090610272168894139235532066195297890820605957380139289247249656912211290268870091660752595059696872262382185067713317116432689408628729642220937968316782103946203421051233201840758380940907269161364979771956231662766935749272290030298347168438839298664987842775626131497578873225186665979219 ]

payload = _sage_const_2 **_sage_const_333  - _sage_const_1 

RAND = [_sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587568049291492293800615049951495318494958592724705602858676879233994302124445140659791546734810989943170 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566643006902224826540565392288758924955959332986323844115579385290546124485418798925365327847293899888 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587571195070661149264565692450679057633526259843574220638356988904634529043381284248414745432338698627886 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566106022909101398389731740153901980312300716487717493723006559548780133067603906830516359129772698830 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587569163096085001136348417235007807048895325685183381353206721858442003436809885045520395013423717833642 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587568939645488133734460826463123128281215949573974953317158270226162420250916723778826057678812467002438 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587567021649577650711030587073913249346330790130463066121302337115590141356777135750100465133439519479772 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566020303375596454491683117839241955073989195341801650578125784026847327256151521544251575953546108052 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587572738835931114795008412518798210798917377929966411997907710561917009689892553082687586330871250960276 , _sage_const_15513663700834955821252944300732666207908906629638457220661970526026453821641377288405473216277587566667458848921699486591979266292401778202294893137875877929891618811098311914713950497660573478162418 ]

'''
d_good*user_input + getPrime(666//2)
user_input == payload == 2^333 -1 > getPrime(666//2), so (d_good*user_input + getPrime(666//2))//user_input == d_good + getPrime(666//2)//user_input == d_good !
''' 

paired_data = sorted(zip(es, Ns), key=lambda x: x[_sage_const_1 ])
#print(paired_data)

Mx = Matrix(ZZ,_sage_const_4 ,_sage_const_4 )
e1 = paired_data[_sage_const_0 ][_sage_const_0 ]
N1 = paired_data[_sage_const_0 ][_sage_const_1 ]
e2 = paired_data[_sage_const_1 ][_sage_const_0 ]
N2 = paired_data[_sage_const_1 ][_sage_const_1 ]
e3 = paired_data[_sage_const_2 ][_sage_const_0 ]
N3 = paired_data[_sage_const_2 ][_sage_const_1 ]

M = int(sqrt(N3))
Mx[_sage_const_0 ] = [M, e1, e2, e3]
Mx[_sage_const_1 ] = [_sage_const_0 , -N1, _sage_const_0 , _sage_const_0 ]
Mx[_sage_const_2 ] = [_sage_const_0 , _sage_const_0 , -N2, _sage_const_0 ]
Mx[_sage_const_3 ] = [_sage_const_0 , _sage_const_0 , _sage_const_0 , -N3]

b = Mx.LLL()
b1 = b[_sage_const_0 ][_sage_const_0 ]
#print(b1)

d = int(abs(b1)/M)
d = (d<<_sage_const_333 ) + RAND[_sage_const_0 ]//payload
print(d)
print(d0)

