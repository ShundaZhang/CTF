#factordb

import gmpy2
p = q = 133150398268195275743440564494273922289580211854275732500110288734747827954102678337833707292013932698242219254622842845639915924282608624204786786392336964091586374322686524012967082822794190857146515192578928726013025527238404636134021379501081455477264698849928505026780491785694428836269895358616314275861

e = 65537

#https://stackoverflow.com/questions/67472553/rsa-crypto-when-p-q
#for p == q, phi = p*(p-1)

############!!!!!!###########
#                           #
#     phi(p,p) = p*(p-1)    #
#                           #
############!!!!!!###########

phi = p*(p-1)

d = gmpy2.invert(e, phi)

print d
#c = 0x2a1c6baa2e940a49c452d719d2f211a9564540c99983ea14d1b9aac186da07f0433f3d58680107a63cdabf53ae0fa10d04bedcd05350cc4ced7195d051e4ccd06f257d40c66574259d6a9425b2f6a78b94159b4041c91df25580452d6d22fe80106837c1b5ea17484e44b43bd3037cb8f4a0c5bc72708a4c538f57d23135e234d1a7eea776704e4501ea9efe79d7e29fb7c0e17246c3136a6692339af104f5539305964478ba3437b96cfe85405325a1d8c24b98a4443c690066a41ebc663066563f44c9cbfeaf205ff82aa3f52b729ecbad3c99184dcea3000957cb8665be850b9267f97cfda789363f13648ebe084c5222080dbf7cf0d4d4edb4c2a3da1d57

c = int(open('chall.enc', 'rb').read().encode('hex'), 16)

print c

n = 0x8c70e2a9590ed6e983dbf4e6db45ad2e9c815c6a089383dccdeaa3c33eff93060b9d023b5650338230bd8c3d5d5fcd19fa42ceaf9c0720375f34ae799c2feabb1fe0ef156dd1828c979cb339b1d4817d18522ffff24d9ae587e27715a85fbec1ec67ee04ac7479f12c33ba7eedc613cfb39528575122f2804cc1ac62558e3d3f5bf7b3ad4d08ed64aca102d2f53dd6dfa8a082c51ceabe3d4eb61b476c1f9be00246e0c236207250d0b1f28fcde677788831048c671c1ef09b1642cde35bb5b5c510d68c3b0a9f5efdf643d34e01b71ad56b3ba277f07379b79764f1935aeddba1f69851c840506e8da51ffb58a9404a789deffdd03406141531d65ee66f11b9

m = pow(c,d,n)
print hex(m)[-128:].decode('hex')

#TFCCTF{1_w0n7_4dm1t_h0w_l0ng_th1s_t00k_4_me...congrats,tho!}
