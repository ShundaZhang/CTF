#https://www.alpertron.com.ar/ECM.HTM
#https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/b00tl3gRSA3.md

import gmpy2

c = 5152519607899109628739431457035808879517994343449784476431278071166044025345528666014737161883592153300144015020246510120824108224320489782971329896268398325808438753815535891777134317831724632458325361507102731939526049349602526343418070946147619312492446321620928838038336480862020386374763597263324208982075129642912718800293286454902704516
n = 16834110841981104760204169468792868891192225871160773202540511987444436529299970790537293923685567355813716083384291252764330314744804325428440704766918700685197626195802448843208237259133032701648586701117021983122419309917923005589454213059031917052897647418805197373381334999691862988151006801154122304019742104149662605059044177025900025047
e = 65537

factors=[8666931953,9000163553,9175442431,9181040581,9567623167,10118816291,10140594833,10362083471,10364696263,10419192599,10776696239,11170437427,11542066919,11801783611,11903290631,11945165513,12648940789,12817194877,13053023677,13148786641,13209433987,13530999631,13954583623,14871287573,14973816953,15052692649,15174506299,15179782147,15276614981,15700842967,16004275739,16844538889,16884679267,17095660297]

phi = 1
for i in factors:
        phi *= i-1
d = gmpy2.invert(e, phi)
m = pow(c,d,n)

print hex(m)[2:].decode('hex')


c = 15551850407972015110291187821360697979390915051062485049803385130125854371644474911342563740017694515413943183757601365983729241978883772718278094191765596310466096637260286849264618333498242718339237097224614273981782901265680812195899149899944172960534293905000078170910972035382698180451636126696572955530374740174915030052504906605673997953
n = 50004751835441699353781131815661480022977055147548834857055672456790372247443703586190040874025849383012259575657233465365175836769445358769404921007750441492091793216547940769192639606704795459757663745137134670490918366862191563048475932552375343390284435865459163879819906400933290167012722204100667269790184165906185719550565718080641455851
e = 65537

factors=[8599906387,8994176501,9138859351,9522442739,9559461677,10208481971,10546721261,10764889007,10826695109,11070352303,11265810449,11518652809,11642688907,11835123991,12451552873,13243158941,14129989169,14169863293,14204852309,14549598953,14640224957,14726440237,14812694579,14848914541,14998252421,15049679987,15148773377,15523250593,15636964307,16132686103,16231297559,16362524999,16395472757,16582393999]

phi = 1
for i in factors:
        phi *= i-1
d = gmpy2.invert(e, phi)
m = pow(c,d,n)

print hex(m)[2:].decode('hex')

