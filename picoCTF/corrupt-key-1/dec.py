from pwn import *
from Crypto.Util.number import *
import gmpy2

n = 0x00b8cb1cca99b6ac41876c18845732a5cbfc875df346ee9002ce608508b5fcf6b60a5ac7722a2d64ef74e1443a338e70a73e63a303f3ac9adf198595699f6e9f30c009d219c7d98c4ec84203610834029c79567efc08f66b4bc3f564bfb571546a06b7e48fb35bb9ccea9a2cd44349f829242078dfa64d525927bfd55d099c024f

p = 12098520864598198757294135341465388062087431109285224283440314414683283061468500249596026217234382854875647811812632201834942205849073893715844547051090363
e = 65537

q = n//p

phi = (p-1)*(q-1)
d = gmpy2.invert(e, phi)

with open('msg.enc', 'rb') as f:
	buf = f.read()

c = bytes_to_long(buf)

m = pow(c,d,n)
#print(hex(m))
print(bytes.fromhex('0'+hex(m)[2:]))
